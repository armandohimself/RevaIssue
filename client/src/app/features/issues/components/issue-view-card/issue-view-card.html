<div class="overlay" (click)="onClose()">
  <div class="card" (click)="$event.stopPropagation()">
    <div class="card-header">
      <h2>Issue Details</h2>
      <button class="close-btn" (click)="onClose()">âœ•</button>
    </div>

    <div class="card-body">
      <div class="field">
        <label>ID</label>
        <span>{{ issue.issueId }}</span>
      </div>

      <div class="field">
        <label>Title</label>
        <span>{{ issue.name }}</span>
      </div>

      <div class="field">
        <label>Description</label>
        <p>{{ issue.description }}</p>
      </div>

      <div class="field-row">
        <div class="field">
          <label>Status</label>
          <span class="status-badge" [class]="issue.status.toLowerCase()">{{ issue.status }}</span>
        </div>

        <div class="field">
          <label>Severity</label>
          <span>{{ issue.severity }}</span>
        </div>

        <div class="field">
          <label>Priority</label>
          <span>{{ issue.priority }}</span>
        </div>
      </div>

      <div class="field-row">
        <div class="field">
          <label>Created By</label>
          <span>{{ issue.createdByUserName }}</span>
        </div>

        <div class="field">
          <label>Assigned To</label>
          <span>{{ issue.assignedToUserName || 'Unassigned' }}</span>
        </div>
      </div>

      <div class="field">
        <label>Last Updated</label>
        <span>{{ issue.updatedAt | date : 'medium' }}</span>
      </div>
      <div class="comments-section">
        <h3>Comments</h3>
        <app-comment-table [issueId]="issue.issueId"></app-comment-table>
      </div>
      <div class="logs-section">
        <h3>History</h3>
        <div class="logs-list">
          @if (logs().length === 0) {
          <p class="no-logs">No history available</p>
          } @for (log of logs(); track log.logId) {
          <div class="log-item">
            <span class="log-date">{{ log.date | date : 'short' }}</span>
            <span class="log-user">{{ log.actingUser.userName }}</span>
            <span class="log-message">{{ log.message }}</span>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
